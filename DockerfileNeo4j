# Use the official Neo4j Docker image as base
FROM neo4j:latest

# Set environment variables for Neo4j
ENV NEO4J_AUTH=neo4j/admin123
#ENV NEO4J_dbms_memory_pagecache_size=1G
#ENV NEO4J_dbms_memory_heap_max__size=2G

# Expose ports
EXPOSE 7474 7473 7687

RUN mkdir -p /var/lib/neo4j/import
RUN chown newuser /var/lib/neo4j/import
USER newuser

# Copy Neo4j import data to the container
COPY ./import /var/lib/neo4j/import

# Copy any additional configuration or data files if needed
# COPY ./path/to/your/config /var/lib/neo4j/conf

# Copy a script that will run the import commands after the container starts
COPY ./import/run_import.sh /var/lib/neo4j/run_import.sh

# Set execute permissions for the script
RUN chmod +x /var/lib/neo4j/run_import.sh

# Start Neo4j when the container starts
CMD ["neo4j"]
# Start Neo4j and run import commands
#CMD neo4j-admin database import full --overwrite-destination --nodes /import/athlete.csv, /import/event.csv, /import/classification.csv --relationships /import/athlete_classification.csv, /import/classification_event.csv neo4j && neo4j start &